%------------------------------------------------------------------------------
% A titlepage - Adapted from a titlepage designed by Ashley Willis.  To use
% this titlepage in your thesis all you need is a line which says
% \phdtitle{title}{name}{date}.
\newcommand{\phdtitle}[4]{%
 \begin{titlepage}
   \begin{tabular}{c}
     \vspace{30mm}
   \end{tabular}
   \begin{center}
     \huge{\sc{#1}}\\
     \vspace{2.5cm}
     \color{black!75}\adforn{21}\color{black}\\
     \vspace{2.5cm}
     \Large{\sc{\hspace{2mm}#2}}
     \vspace{0.5cm}\\
   	 \Large{#3}\\ 
     \vspace{2.5cm}
     \emph{\small
       Thesis submitted for the degree of\\
       \hspace{2mm}
       Doctor of Philosophy\\
       \vspace{0.2cm}
       to the\\
       \vspace{0.3cm}
       School of Mathematics \& Statistics\\
       Newcastle University\\
       Newcastle upon Tyne\\
       United Kingdom\\
     }        
   \end{center}
 \end{titlepage}
}
%------------------------------------------------------------------------------

%------------------------------------------------------------------------------
% A new acknowledgements environment.  As far as I am aware LaTeX does not
% provide an acknowledgement environment; so here's one!  Just use
% \begin{acknowledgements}...\end{acknowledgements} as usual.
\makeatletter
\newenvironment{acknowledgements}{
  \titlepage\null\vfil
  \@beginparpenalty\@lowpenalty
  \begin{center}%
    \bfseries Acknowledgements \@endparpenalty\@M
  \end{center}%
  }{
  \par\vfil\null\endtitlepage
}
\makeatother
%------------------------------------------------------------------------------

%------------------------------------------------------------------------------
% Packages used by default style file
\usepackage[round]{natbib}              % BiBTeX style
\usepackage{fancyhdr}                   % Fancy headers
\usepackage[centertags]{amsmath}        % AMS Stuff
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{psfrag}                     % PSFrag (LaTeX style labels)
\usepackage{dcolumn}                    % Line up at decimal point in a table
\usepackage{graphicx}                   % Graphics stuff
\usepackage[usenames,dvipsnames,svgnames,table]{xcolor} %Colours
\usepackage[small]{caption}             % Captions
\usepackage{enumerate}                  % Enumerated lists
\usepackage{mathrsfs}                   % Serif fonts
\usepackage{longtable}                  % Stretch tables
\usepackage{lscape}                     % Landscape mode
\usepackage{afterpage}                  % Clear a page
\usepackage[figuresright]{rotating}     % Rotate a figure
\usepackage{setspace}                   % Spacing tools

% Extra packages which I've added
\usepackage{adforn}
\usepackage{algorithm}
\usepackage{algorithmic}
\usepackage{array}
\usepackage{bm}
\usepackage{booktabs}
\usepackage{calc}
% Color captions in figures
\usepackage[labelfont={color=my_purple}]{caption}
\usepackage{etoolbox}
\usepackage{float}
\usepackage[hidelinks]{hyperref}
% Use microtype with settings as found online
\usepackage[activate={true,nocompatibility},final,tracking=true,kerning=true,spacing=true,factor=1100,
stretch=10,shrink=10]{microtype}
% Use MinionPro font --- comment this line if not installed on system
% MinionPro can be installed to use with pdflatex with the fontpro package
\usepackage[mathlf]{MinionPro}
\usepackage{multirow}
\usepackage{pgf}
\usepackage{pgfplots}
% For backwards compatability (?)
\pgfplotsset{compat=1.13}
\usepackage{pgfplotstable}
\usepackage{physics}
\usepackage{standalone}
% Remove extra brackets around subfigure caption created when adding brackets to subref
\usepackage[labelformat=simple]{subcaption}
\usepackage{titlesec}
\usepackage{tikz}
%------------------------------------------------------------------------------

%------------------------------------------------------------------------------
% Custom colors
\definecolor{my_purple}{HTML}{660066}
\colorlet{grey}{white!40!black}
%------------------------------------------------------------------------------

%------------------------------------------------------------------------------
% Set up how hyperlinks are to be typeset
\hypersetup{
	linktocpage=true,
	pdfmenubar=true,
    colorlinks=true,
    linkcolor=my_purple,
    urlcolor=my_purple,
    citecolor=black,
}
%------------------------------------------------------------------------------

%------------------------------------------------------------------------------
% Formatting of part, chapter, section etc.
\newcommand\titlehang[1]{%
	\llap{%
		#1\hspace{2.5mm}
	}%
}

\newcommand\YUGE{\fontsize{100}{120}\selectfont}

\titleformat{\part}
  [display] %shape
  {\centering\Huge\scshape} % format applied to label+text
  {\color{partcolor}\textsc{\partname~\thepart}}% label
  {0pt}% horizontal separation between label and title body
  {} % before the title body
  [] %after the title body

\titleformat{\chapter}%
  [display]% shape
  {\YUGE\color{black!75}}% format applied to label
  {$\thechapter$}% label (use mathmode to use lined figures)
  {-1cm}% horizontal separation between label and title body
  {\huge\itshape\color{grey}}% format of title
  [\hrule]% after the title body

\titleformat{\section}%
  [block]% shape
  {\Large}% format applied to label+text
  {\titlehang\thesection}% label
  {0em}% horizontal separation between label and title body
  {\scshape}% before the title body
  []% after the title body

\titleformat{\subsection}%
  [block]% shape
  {\large}% format applied to label+text
  {\titlehang\thesubsection}% label
  {0em}% horizontal separation between label and title body
  {\itshape}% before the title body
  []% after the title body

\titlespacing*{\chapter}{0pt}{10pt}{2ex plus 1ex}
\titlespacing*{\section}{0pt}{3.5ex plus 1ex minus .2ex}{2.3ex plus .2ex}
\titlespacing*{\subsection}{0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus.2ex}

%----------------------------------------------------------------------------

%----------------------------------------------------------------------------
% Fancy headers
\pagestyle{fancy}
% Clear defaults
\fancyhf{}
% Remove hrule underneath header
\renewcommand{\headrulewidth}{0pt}
% See Figure 3 of fancyhdr documentation
\renewcommand{\chaptermark}[1]{\markboth{#1}{}}
\renewcommand{\sectionmark}[1]{\markright{#1}{}}
% Chapter title
\fancyhead[RO]{\textsc{\rightmark}\quad\thepage}
% Section title
\fancyhead[LE]{\thepage\quad\textsc{\leftmark}}

% page style is plain for new chapters
\fancypagestyle{plain}{% % <-- this is new
  \fancyhf{} 
  \fancyfoot[LE,RO]{\thepage}}
%------------------------------------------------------------------------------

%------------------------------------------------------------------------------
% Array strut to make delimiters come out right size both ends.
\newsavebox{\astrutbox}
\sbox{\astrutbox}{\rule[-5pt]{0pt}{20pt}}
\newcommand{\astrut}{\usebox{\astrutbox}}
%------------------------------------------------------------------------------

%------------------------------------------------------------------------------
% Make latex more willing to fill a page with large floats and small 
% amounts of text.
\renewcommand{\textfraction}{0.05}
\renewcommand{\topfraction}{0.9}
\renewcommand{\bottomfraction}{0.9}
\renewcommand{\floatpagefraction}{0.8}
%------------------------------------------------------------------------------

%------------------------------------------------------------------------------
% Extra commands which I've added to the style file
% Bracket references to subfigures
\renewcommand\thesubfigure{(\alph{subfigure})}
% Automatically center all floats and remove need to add \centering all the
% time 
\makeatletter
\g@addto@macro\@floatboxreset{\centering}
\makeatother