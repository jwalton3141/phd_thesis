%------------------------------------------------------------------------------
% A titlepage - Adapted from a titlepage designed by Ashley Willis.  To use
% this titlepage in your thesis all you need is a line which says
% \phdtitle{title}{name}{image}{date}.  Any other changes can be made below.
\newcommand{\phdtitle}[4]{%
 \begin{titlepage}
   \begin{tabular}{c}
     \vspace{30mm}
   \end{tabular}
   \begin{center}
     \LARGE{\sc{#1}}\\
     \vspace{1.5cm}
     \Large{\sc{\hspace{2mm}#2}}
     \vspace{2cm}\\
     \Large{Thesis submitted for the degree of\\
     \hspace{2mm}
     Doctor of Philosophy}         
     \vspace{1cm}\\         
     \begin{tabular}{c}
       \hspace{2mm}
       {\includegraphics[width=0.55\textwidth]{#3}}
     \end{tabular}
     \mbox{}
     \vspace{0.6cm}\\
     \emph{\small
       School of Mathematics, Statistics \& Physics\\
       Newcastle University\\
       Newcastle upon Tyne\\
       United Kingdom\\
     }
     \vspace{1cm}\Large{#4}\\         
   \end{center}
 \end{titlepage}
}
%------------------------------------------------------------------------------

%------------------------------------------------------------------------------
% A new acknowledgements environment.  As far as I am aware LaTeX does not
% provide an acknowledgement environment; so here's one!  Just use
% \begin{acknowledgements}...\end{acknowledgements} as usual.
\makeatletter
\newenvironment{acknowledgements}{
  \titlepage\null\vfil
  \@beginparpenalty\@lowpenalty
  \begin{center}%
    \bfseries Acknowledgements \@endparpenalty\@M
  \end{center}%
  }{
  \par\vfil\null\endtitlepage
}
\makeatother
%------------------------------------------------------------------------------

%------------------------------------------------------------------------------
% A dedication environment.  Use \begin{dedication}...\end{dedication}.  This
% will set aside a full page with italic text centred horizontally and
% vertically.
\makeatletter
\newenvironment{dedication}{
  \titlepage\null\vfil
  \begin{center}%
    \itshape
    }{
  \end{center}%
\par\vfil\null\endtitlepage
}
\makeatother
%------------------------------------------------------------------------------

%------------------------------------------------------------------------------
% Provides dot-dashed lines.  There doesn't appear to be an easy way of making
% dotted or dashed lines in LaTeX, so here are some pre-defined linestyles.
\def\dashedrule#1#2#3#4#5{{%
	% #1 is length of first dash
	% #2 is length of gap between two consecutive first dashes
	% #3 is length of second dash
	% #4 is length of gap between two consecutive second dashes
	% #5 is number of dashes
	\dimen1=#2 \divide\dimen1 by 2
	\dimen2=#4 \divide\dimen2 by 2
	\def\@ruledash{%
		\rule{\dimen1}{0pt}%
		\rule[0.5ex]{#1}{0.4pt}%
		% line is 0.5ex above the baseline
		% and 0.4pt thick
		\rule{\dimen1}{0pt}%
		\rule{\dimen2}{0pt}%
		\rule[0.5ex]{#3}{0.4pt}%
		\rule{\dimen2}{0pt}}%
	\count1=0
	\loop%
	\ifnum\count1<#5%
	\advance\count1 by 1%
	\@ruledash%
\repeat}}

% These are the definitions.  You must say \protect\longdashes,
% \protect\shortdashes etc. in your document to get a short line of the
% specified style.  You can define more here if you want.  The length of a line
% segment is (#1+#2+#3+#4)*#5
\def\longdashes{\dashedrule{0.8em}{0.2em}{0.0em}{0.0em}{3}}
\def\mediumdashes{\dashedrule{0.3em}{0.2em}{0.0em}{0.0em}{6}}
\def\shortdashes{\dashedrule{0.1em}{0.1em}{0.0em}{0.0em}{15}}
\def\sparsedashes{\dashedrule{0.5em}{0.5em}{0.0em}{0.0em}{3}}
\def\solidline{\dashedrule{3em}{0.0em}{0.0em}{0.0em}{1}}
\def\dotdashline{\dashedrule{0.5em}{0.1em}{0.1em}{0.3em}{3}}
%------------------------------------------------------------------------------

% Any external packages that you require can be inserted here.
\usepackage[round]{natbib}              % BiBTeX style
\usepackage{fancyhdr}                   % Fancy headers
\usepackage[centertags]{amsmath}        % AMS Stuff
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{psfrag}                     % PSFrag (LaTeX style labels)
\usepackage{dcolumn}                    % Line up at decimal point in a table
\usepackage{graphicx}                   % Graphics stuff
\usepackage[usenames,dvipsnames,svgnames,table]{xcolor} %Colours
\usepackage[small]{caption}             % Captions
\usepackage{enumerate}                  % Enumerated lists
\usepackage{mathrsfs}                   % Serif fonts
\usepackage{longtable}                  % Stretch tables
\usepackage{lscape}                     % Landscape mode
\usepackage{afterpage}                  % Clear a page
\usepackage[figuresright]{rotating}     % Rotate a figure
\usepackage{setspace}                   % Spacing tools

% My extra packages
\usepackage{algorithm}
\usepackage{algorithmic}
\usepackage{array}
\usepackage{bm}
\usepackage{booktabs}
\usepackage{calc}
\usepackage{float}
\usepackage{multirow}
\usepackage{pgf}
\usepackage{pgfplots}
\pgfplotsset{compat=1.13}
\usepackage{pgfplotstable}
\usepackage{physics}
\usepackage{standalone}
\usepackage{subcaption}
\usepackage{tikz}


% Some people like the palatino text/math fonts. Uncomment these lines to use them
%\usepackage[T1]{fontenc}
%\usepackage{newpxtext}
%\linespread{1.2}
%\usepackage[bigdelims,vvarbb]{newpxmath}


%----------------------------------------------------------------------------
% Fancy headers.  See the fancyhdr documentation of a full explanation of what
% these are.  R=Right hand side of page, L=Left hand side of page
\pagestyle{fancy}
\fancyhead[R]{\slshape\nouppercase\leftmark}
\fancyhead[L]{}
%------------------------------------------------------------------------------

%------------------------------------------------------------------------------
% Make all upper-case Greek letters slanted.  Just comment these if you prefer
% upright Greek letters.
\DeclareMathSymbol{\Gamma}{\mathalpha}{letters}{"00}
\DeclareMathSymbol{\Delta}{\mathalpha}{letters}{"01}
\DeclareMathSymbol{\Theta}{\mathalpha}{letters}{"02}
\DeclareMathSymbol{\Lambda}{\mathalpha}{letters}{"03}
\DeclareMathSymbol{\Xi}{\mathalpha}{letters}{"04}
\DeclareMathSymbol{\Pi}{\mathalpha}{letters}{"05}
\DeclareMathSymbol{\Sigma}{\mathalpha}{letters}{"06}
\DeclareMathSymbol{\Upsilon}{\mathalpha}{letters}{"07}
\DeclareMathSymbol{\Phi}{\mathalpha}{letters}{"08}
\DeclareMathSymbol{\Psi}{\mathalpha}{letters}{"09}
\DeclareMathSymbol{\Omega}{\mathalpha}{letters}{"0A}
%------------------------------------------------------------------------------

\font\sfs = cmssi10 % sans-serif slanted
\font\sfb = cmssi10 % sans-serif bold maths
\font\sls = cmssi10 % sans-serif bold maths, italic

%------------------------------------------------------------------------------
% Various miscellaneous new commands.
\newcommand\etc{etc.\ }
\newcommand\eg{e.g.\ }
\newcommand\ie{i.e.\ }

% Independence symbol
\newcommand\independent{\protect\mathpalette{\protect\independenT}{\perp}}
\def\independenT#1#2{\mathrel{\rlap{$#1#2$}\mkern2mu{#1#2}}}

%------------------------------------------------------------------------------
% Theorems, corollaries, etc.
% Here, theorems, lemmas, corollaries, and propositions are numbered within
% chapters; proofs, definitions, examples, and remarks are not numbered.  Just
% alter the commands below if you would prefer different numberings or no
% numbering at all.

% Numbered.
\newtheorem{theorem}{Theorem}[chapter]
\newtheorem{lemma}{Lemma}[chapter]
\newtheorem{corollary}{Corollary}[chapter]
\newtheorem{proposition}{Proposition}[chapter]

% Not numbered.
\theoremstyle{definition}
\newtheorem*{definition}{Definition}
\theoremstyle{definition}
\newtheorem*{example}{Example}
\theoremstyle{definition}
\newtheorem*{remark}{Remark}
%------------------------------------------------------------------------------

%------------------------------------------------------------------------------
% Array strut to make delimiters come out right size both ends.
\newsavebox{\astrutbox}
\sbox{\astrutbox}{\rule[-5pt]{0pt}{20pt}}
\newcommand{\astrut}{\usebox{\astrutbox}}
%------------------------------------------------------------------------------

%------------------------------------------------------------------------------
% Make latex more willing to fill a page with large floats and small 
% amounts of text.
\renewcommand{\textfraction}{0.05}
\renewcommand{\topfraction}{0.9}
\renewcommand{\bottomfraction}{0.9}
\renewcommand{\floatpagefraction}{0.8}
%------------------------------------------------------------------------------

%------------------------------------------------------------------------------
% Automatically center all floats and remove need to add \centering all the
% time 
\makeatletter
\g@addto@macro\@floatboxreset{\centering}
\makeatother
%------------------------------------------------------------------------------

%------------------------------------------------------------------------------
% Make my own custom colours to match the default color cycle provided by the
% python plotting package seaborn
\definecolor{seaborn_blue}{HTML}{4C72B0}
\definecolor{seaborn_green}{HTML}{55A868}
\definecolor{seaborn_red}{HTML}{C44E52}
\definecolor{seaborn_purple}{HTML}{8172B2}
\definecolor{seaborn_yellow}{HTML}{CCB974}
\definecolor{seaborn_cyan}{HTML}{64B5CD}
\definecolor{seaborn_grid}{HTML}{EAEAF2}

\colorlet{seaborn_blue2}{seaborn_blue!30}


